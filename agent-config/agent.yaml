# Algolia Agent Configuration
# This file defines the agent's behavior and can be synced with the Algolia Agent API

agent:
  id: 26cc363c-f96a-4170-bf36-46b734a6936a
  name: "Airbnb Search Guide"
  description: "Guides users through Airbnb search with intelligent facet suggestions"

  # System prompt that defines the agent's behavior
  systemPrompt: |
    # Airbnb Search Assistant Prompt

    You are a **concise Airbnb search assistant**. Guide users with **short, helpful messages** and **exactly ONE filter choice**, unless the search is already perfectly refined.

    ---

    ## ðŸ”‘ Critical Rule

    * **Always provide exactly ONE filter option in your response.**
    * **Exception:** If the search has **5 or fewer results**, no filter is needed (just congratulate the user).

    ---

    ## ðŸŽ¯ Response Strategy

    * **Many results (50+)** â†’ Suggest the **most impactful single filter** in priority order:

      1. Location
      2. Property type
      3. Price
    * **Moderate results (10â€“49)** â†’ Suggest **one refinement filter**.
    * **Few results (6â€“9)** â†’ Suggest **one filter** that might **expand or refine**.
    * **Perfect results (1â€“5)** â†’ **No filter needed**, congratulate user.

    ---

    ## ðŸ“¦ Required Response Format

    Always respond with a **single JSON object** with **two top-level keys**:

    1. **`text`** â†’ A brief (1â€“2 sentences max) message about the current search state.
    2. **`filters`** â†’ Either:

       * One filter suggestion in this format:

    ```json
    {
      "text": "Your brief message here.",
      "filters": {
        "category": "location|property|price|amenities",
        "options": [
          {
            "label": "Option Name",
            "value": "filter_value",
            "count": 123
          }
        ]
      }
    }
    ```

    * Or `null` if no filter is needed (perfect results):

    ```json
    {
      "text": "Looks great! We've narrowed it down perfectly.",
      "filters": null
    }
    ```

    ---

    ## ðŸ§© Context Variables Available

    * **Current filters applied**
    * **Exact number of results matching current filters**
    * **Available facets and their counts**

  # Model configuration
  model:
    provider: "openai"
    name: "gpt-4.1"
    temperature: 0.7
    maxTokens: 500

  # Index configuration
  index:
    name: "algoliaBNB"
    searchParameters:
      hitsPerPage: 20
      attributesToRetrieve:
        - objectID
        - name
        - description
        - price
        - property_type
        - room_type
        - city
        - neighborhood
        - picture_url
        - xl_picture_url
        - person_capacity
        - bedrooms
        - beds
        - bathrooms
        - reviews_count
        - rating

  # Facet configuration
  facets:
    - attribute: city
      label: "Location"
      type: "refinementList"
      limit: 10
      sortBy: ["count:desc", "name:asc"]

    - attribute: property_type
      label: "Property Type"
      type: "refinementList"
      limit: 8
      sortBy: ["count:desc"]

    - attribute: room_type
      label: "Room Type"
      type: "refinementList"
      limit: 6
      sortBy: ["count:desc"]

    - attribute: price
      label: "Price Range"
      type: "range"

    - attribute: person_capacity
      label: "Guests"
      type: "refinementList"
      limit: 6
      sortBy: ["name:asc"]

    - attribute: bedrooms
      label: "Bedrooms"
      type: "refinementList"
      limit: 5
      sortBy: ["name:asc"]

  # Behavioral flags
  behavior:
    proactive: true  # Proactively suggest next steps
    adaptive: true   # Adapt based on result count
    contextAware: true  # Use search context in responses
    fallbackEnabled: false  # No fallback - app should visibly fail if agent unavailable
    alwaysShowFilters: true  # Always expose filter choices (except final stage)
    minFiltersToShow: 1  # Always show exactly one filter option
    maxFiltersToShow: 1  # Always show exactly one filter option
